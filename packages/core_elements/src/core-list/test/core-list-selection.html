<!doctype html><html><head><title>core-list</title><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><script src="../../webcomponentsjs/webcomponents.js"></script><script src="../../web-component-tester/browser.js"></script><link rel=import href="../core-list.html"><style>body{margin:0;height:100%}core-list{display:block;height:100%;margin:0 auto}input{width:20px}.item{height:80px;background:lightblue}.item.selected{background:orange}</style></head><body fit><core-list id=list><template><div class="item {{ selected ? 'selected' : '' }}"><span id=index>{{index}}</span><br><span id=id>{{model.id}}</span><br><input id=checkbox type=checkbox checked"{{model.checked}}"><input id=input type=number _value="{{model.value}}" class=narrow><select id=select selectedIndex="{{model.type}}"><option>a</option><option>b</option><option>c</option></select></div></template></core-list><script>test("core-list-selection",function(d){var g=document.querySelector("core-list");var c=80;var b=Math.ceil(g.offsetHeight/c);var e=0;var f;var a=function(){return{id:Math.floor(Math.random()*10000),checked:!!Math.floor(Math.random()*2),value:Math.floor(Math.random()*10000),type:Math.floor(Math.random()*3)}};async.series([function(i){var h=b*20;g.data=[];while(h--){g.data.push(a())}waitFor(function(){chai.assert(g.children.length>b+1,"children.length should be > "+b+" (1 template + max number of elements")},i)},function(h){waitFor(function(){f=document.elementFromPoint(g.clientWidth-50,0*c);chai.assert(!!f,"item should exist at top of list");f.dispatchEvent(new MouseEvent("tap",{view:window,bubbles:true}))},h)},function(h){waitFor(function(){chai.assert(g.selection&&g.selection==g.data[0],"first item should be selected; selected id was "+g.selection&&g.selection.id);chai.assert(f.classList.contains("selected"),"first item should have selected class")},h)},function(h){var i=document.elementFromPoint(g.clientWidth-50,0*c);var j=document.elementFromPoint(g.clientWidth-50,2*c);j.dispatchEvent(new MouseEvent("tap",{view:window,bubbles:true}));waitFor(function(){chai.assert(g.selection&&g.selection==g.data[2],"third item should be selected; selected id was "+g.selection&&g.selection.id);chai.assert(!i.classList.contains("selected"),"first item should not have selected class");chai.assert(j.classList.contains("selected"),"third item should have selected class")},h)},function(h){var i=document.elementFromPoint(g.clientWidth-50,0*c);var j=document.elementFromPoint(g.clientWidth-50,2*c);i.dispatchEvent(new MouseEvent("tap",{view:window,bubbles:true}));waitFor(function(){chai.assert(g.selection&&g.selection==g.data[0],"first item should be selected; selected id was "+g.selection&&g.selection.id);chai.assert(i.classList.contains("selected"),"first item should have selected class");chai.assert(!j.classList.contains("selected"),"third item should not have selected class")},h)},function(h){g.data.splice(0,0,a());waitFor(function(){chai.assert(g.selection&&g.selection==g.data[1],"second item should be selected; selected id was "+g.selection&&g.selection.id)},h)},function(h){g.data.splice(2,0,a());waitFor(function(){chai.assert(g.selection&&g.selection==g.data[1],"second item should be selected; selected id was "+g.selection&&g.selection.id)},h)},function(h){g.multi=true;waitFor(function(){chai.assert(g.selection.length==1,"selection length should be 1");chai.assert(g.selection&&g.selection[0]==g.data[1],"second item should be selected; selected id was "+g.selection&&g.selection.id)},h)},function(i){var j=document.elementFromPoint(g.clientWidth-50,0*c);var h=document.elementFromPoint(g.clientWidth-50,1*c);var k=document.elementFromPoint(g.clientWidth-50,2*c);j.dispatchEvent(new MouseEvent("tap",{view:window,bubbles:true}));k.dispatchEvent(new MouseEvent("tap",{view:window,bubbles:true}));waitFor(function(){chai.assert(g.selection.length==3,"selection length should be 3");chai.assert(g.selection&&g.selection[0]==g.data[1],"second item should be selected; selected id was "+g.selection[0]&&g.selection[0].id);chai.assert(g.selection&&g.selection[1]==g.data[0],"first item should be selected; selected id was "+g.selection[1]&&g.selection[1].id);chai.assert(g.selection&&g.selection[2]==g.data[2],"third item should be selected; selected id was "+g.selection[2]&&g.selection[2].id);chai.assert(j.classList.contains("selected"),"first item should have selected class");chai.assert(h.classList.contains("selected"),"second item should have selected class");chai.assert(k.classList.contains("selected"),"third item should have selected class")},i)},function(i){g.multi=false;var j=document.elementFromPoint(g.clientWidth-50,0*c);var h=document.elementFromPoint(g.clientWidth-50,1*c);var k=document.elementFromPoint(g.clientWidth-50,2*c);waitFor(function(){chai.assert(!g.selection,"selection length should be 3");chai.assert(!j.classList.contains("selected"),"first item should not have selected class");chai.assert(!h.classList.contains("selected"),"second item should not have selected class");chai.assert(!k.classList.contains("selected"),"third item should not have selected class")},i)},function(h){g.selectItem(1);f=document.elementFromPoint(g.clientWidth-50,1*c);waitFor(function(){chai.assert(g.selection&&g.selection==g.data[1],"second item should be selected; selected id was "+(g.selection&&g.selection.id));chai.assert(f.classList.contains("selected"),"second item should have selected class")},h)},function(i){g.multi=true;g.selectItem(0);g.selectItem(2);var j=document.elementFromPoint(g.clientWidth-50,0*c);var h=document.elementFromPoint(g.clientWidth-50,1*c);var k=document.elementFromPoint(g.clientWidth-50,2*c);waitFor(function(){chai.assert(g.selection.length==3,"selection length should be 3");chai.assert(g.selection&&g.selection[0]==g.data[1],"second item should be selected; selected id was "+g.selection[0]&&g.selection[0].id);chai.assert(g.selection&&g.selection[1]==g.data[0],"first item should be selected; selected id was "+g.selection[1]&&g.selection[1].id);chai.assert(g.selection&&g.selection[2]==g.data[2],"third item should be selected; selected id was "+g.selection[2]&&g.selection[2].id);chai.assert(j.classList.contains("selected"),"first item should have selected class");chai.assert(h.classList.contains("selected"),"second item should have selected class");chai.assert(k.classList.contains("selected"),"third item should have selected class")},i)},function(h){g.clearSelection();chai.assert(g.selection.length===0,"selection length should be 0 after calling clearSelection when multi:true");g.multi=false;g.selectItem(0);g.clearSelection();chai.assert(!g.selection,"selection should be null after calling clearSelection when multi:false");h()}],d)});</script></body></html>