suite("matrix interpolation",function(){function t(t,a,r){var e=t.slice(t.indexOf("(")+1,t.lastIndexOf(")")).split(",");assert.equal(e.length,r);for(var i=0;r>i;i++)assert.closeTo(Number(e[i]),a[i],.01)}function a(t,a,r){var e=webAnimationsMinifill.propertyInterpolation("transform",t[0],t[1]),i=webAnimationsMinifill.propertyInterpolation("transform",a[0],a[1]),n=e(r),o=i(r),s=n.slice(n.indexOf("(")+1,n.lastIndexOf(")")).split(","),l=o.slice(o.indexOf("(")+1,o.lastIndexOf(")")).split(",");assert.equal(s.length,l.length);for(var p=0;p<l.length;p++)assert.closeTo(Number(s[p]),Number(l[p]),.01)}test("transform interpolations with matrices only",function(){var a=webAnimationsMinifill.propertyInterpolation("transform","matrix(1, 0, 0, 1, 0, 0)","matrix(1, -0.2, 0, 1, 0, 0)"),r=a(.5);t(r,[1,-.1,0,1,0,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","matrix(1, 0, 0, 1, 0, 0)","matrix3d(1, 1, 0, 0, -2, 1, 0, 0, 0, 0, 1, 0, 10, 10, 0, 1)"),r=a(.5),t(r,[1.12,.46,-.84,1.34,5,5],6),a=webAnimationsMinifill.propertyInterpolation("transform","matrix(1, 0, 0, 1, 0, 0)","matrix3d(1, 1, 3, 0, -2, 1, 0, 0, 0, 0, 1, 0, 10, 10, 0, 1)"),r=a(.5),t(r,[1.73,.67,1.1,0,-.85,1.34,.29,0,-.35,-.22,.58,0,5,5,0,1],16),a=webAnimationsMinifill.propertyInterpolation("transform","matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)","matrix3d(1, 2, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 10, 10, 1)"),r=a(.5),t(r,[1.38,.85,0,0,.24,1,0,0,0,0,1,0,0,5,5,1],16),a=webAnimationsMinifill.propertyInterpolation("transform","matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)","matrix3d(1, 1, 0, 0, -2, 1, 0, 0, 0, 0, 1, 0, 10, 10, 0, 1)"),r=a(.5),t(r,[1.12,.46,-.84,1.34,5,5],6),interp=webAnimationsMinifill.propertyInterpolation("transform","matrix(1, 0, 0, 1, 0, 0)","matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 2)"),r=interp(.4),t(r,[1,0,0,1,0,0],6),r=interp(.6),t(r,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,2],16)}),test("transform interpolations with matrices and other functions",function(){var a=webAnimationsMinifill.propertyInterpolation("transform","translate(100px) matrix(1, 0, 0, 1, 0, 0)","translate(10px) matrix(1, -0.2, 0, 1, 0, 0)"),r=a(.5),e=r.split(" ");assert.equal(e.length,2),assert.equal(e[0],"translate(55px,0px)"),t(e[1],[1,-.1,0,1,0,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","translate(100px) matrix(1, 0, 0, 1, 0, 0) rotate(10deg)","translate(10px) matrix(1, -0.2, 0, 1, 0, 0) rotate(100deg)"),r=a(.5),e=r.split(" "),assert.equal(e.length,3),assert.equal(e[0],"translate(55px,0px)"),t(e[1],[1,-.1,0,1,0,0],6),assert.equal(e[2],"rotate(55deg)"),a=webAnimationsMinifill.propertyInterpolation("transform","translate(100px) matrix(1, 0, 0, 1, 0, 0) rotate(10deg)","translate(10px) matrix3d(1, 2, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 10, 10, 1) rotate(100deg)"),r=a(.5),e=r.split(" "),assert.equal(e.length,3),assert.equal(e[0],"translate(55px,0px)"),t(e[1],[1.38,.85,0,0,.24,1,0,0,0,0,1,0,0,5,5,1],16),assert.equal(e[2],"rotate(55deg)"),a=webAnimationsMinifill.propertyInterpolation("transform","matrix(1, 0, 0, 1, 0, 0) translate(100px)","translate(10px) matrix(1, -0.2, 0, 1, 0, 0)"),r=a(.5),t(r,[1,-.1,0,1,55,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","translate(100px) matrix(1, 0, 0, 1, 0, 0) rotate(10deg)","translate(10px) matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 2) rotate(100deg)"),r=a(.4),e=r.split(" "),assert.equal(e.length,3),assert.equal(e[0],"translate(64px,0px)"),t(e[1],[1,0,0,1,0,0],6),assert.equal(e[2],"rotate(46deg)"),r=a(.6),e=r.split(" "),assert.equal(e.length,3),assert.equal(e[0],"translate(46px,0px)"),t(e[1],[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,2],16),assert.equal(e[2],"rotate(64deg)"),a=webAnimationsMinifill.propertyInterpolation("transform","translate(10px) matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 2) rotate(100deg)","translate(100px) matrix(1, 0, 0, 1, 0, 0) rotate(10deg)"),r=a(.4),e=r.split(" "),assert.equal(e.length,3),assert.equal(e[0],"translate(46px,0px)"),t(e[1],[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,2],16),assert.equal(e[2],"rotate(64deg)"),r=a(.6),e=r.split(" "),assert.equal(e.length,3),assert.equal(e[0],"translate(64px,0px)"),t(e[1],[1,0,0,1,0,0],6),assert.equal(e[2],"rotate(46deg)")}),test("transform interpolations that require matrix decomposition",function(){var a=webAnimationsMinifill.propertyInterpolation("transform","translate(10px)","scale(2)"),r=a(.4);t(r,[1.4,0,0,1.4,6,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","rotateX(10deg)","rotateY(20deg)"),r=a(.4),t(r,[.99,.01,-.14,0,.01,1,.1,0,.14,-.1,.98,0,0,0,0,1],16),a=webAnimationsMinifill.propertyInterpolation("transform","rotate(0rad) translate(0px)","translate(800px) rotate(9rad)"),r=a(.4),t(r,[.47,.89,-.89,.47,320,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","rotateX(10deg)","translate(10px) rotateX(200deg)"),r=a(.4),t(r,[1,0,0,0,0,.53,-.85,0,0,.85,.53,0,4,0,0,1],16),a=webAnimationsMinifill.propertyInterpolation("transform","translate(0px)","translate(800px) rotate(9rad)"),r=a(.4),t(r,[.47,.89,-.89,.47,320,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","translate(0px, 0px) rotate(0deg) scale(1)","translate(900px, 190px) scale(3) rotate(9rad)"),r=a(.4),t(r,[.84,1.59,-1.59,.84,360,76],6),a=webAnimationsMinifill.propertyInterpolation("transform","perspective(1000px)","perspective(200px)"),r=a(.2),t(r,[1,0,0,0,0,1,0,0,0,0,1,-.0018,0,0,0,1],16)}),test("transforms that decompose to a 2D matrix result in a 2D matrix transform in computed style",function(){var t=document.createElement("div");document.body.appendChild(t);var a=t.animate([{transform:"translate(100px)"},{transform:"rotate(45deg)"}],2e3);a.currentTime=500,a.pause();var r=getComputedStyle(t).transform||getComputedStyle(t).webkitTransform,e=r.slice(r.indexOf("(")+1,r.lastIndexOf(")")).split(",");assert.equal(e.length,6)}),test("decompose various CSS properties",function(){var a=webAnimationsMinifill.propertyInterpolation("transform","rotateX(110deg)","rotateX(10deg) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5);t(r,[1,0,0,0,0,.5,.866,0,0,-.866,.5,0,0,0,0,1],16),a=webAnimationsMinifill.propertyInterpolation("transform","rotateY(10rad)","rotateY(2rad) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[.96,0,.279,0,0,1,0,0,-.279,0,.96,0,0,0,0,1],16),a=webAnimationsMinifill.propertyInterpolation("transform","rotate(320deg)","rotate(10deg) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[.966,-.259,.259,.966,0,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","rotateZ(10rad)","rotateZ(2rad) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[.96,-.279,.279,.96,0,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","rotate3d(1, 1, 1, 100deg)","rotate3d(1, 1, 1, 200deg) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[.911,-.244,.333,0,.333,.911,-.244,0,-.244,.333,.911,0,0,0,0,1],16),a=webAnimationsMinifill.propertyInterpolation("transform","scale(10)","scale(2) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[6,0,0,6,0,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","scalex(10)","scalex(2) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[6,0,0,1,0,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","scaley(10)","scaley(2) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[1,0,0,6,0,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","scalez(10)","scalez(2) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[1,0,0,0,0,1,0,0,0,0,6,0,0,0,0,1],16),a=webAnimationsMinifill.propertyInterpolation("transform","scale3d(6, 8, 10)","scale3d(2, 2, 2) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[4,0,0,0,0,5,0,0,0,0,6,0,0,0,0,1],16),a=webAnimationsMinifill.propertyInterpolation("transform","skew(30deg)","skew(0deg) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[1,0,.289,1,0,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","skewx(3rad)","skewx(1rad) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[1,0,.707,1,0,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","skewy(3rad)","skewy(1rad) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[1.301,.595,.174,.921,0,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","translate(10px, 20px)","translate(100px, 200px) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[1,0,0,1,55,110],6),a=webAnimationsMinifill.propertyInterpolation("transform","translatex(10px)","translatex(100px) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[1,0,0,1,55,0],6),a=webAnimationsMinifill.propertyInterpolation("transform","translatey(10px)","translatey(100px) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[1,0,0,1,0,55],6),a=webAnimationsMinifill.propertyInterpolation("transform","translatez(20px)","translatez(200px) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,110,1],16),a=webAnimationsMinifill.propertyInterpolation("transform","translate3d(10px, 10px, 10px)","translate3d(20px, 20px, 20px) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[1,0,0,0,0,1,0,0,0,0,1,0,15,15,15,1],16),a=webAnimationsMinifill.propertyInterpolation("transform","perspective(300px)","perspective(900px) matrix(1, 0, 0, 1, 0, 0)"),r=a(.5),t(r,[1,0,0,0,0,1,0,0,0,0,1,-.002222,0,0,0,1],16)}),test("decompose various CSS properties with unsupported units",function(){a(["rotateX(110grad)","rotateX(10deg) matrix(1, 0, 0, 1, 0, 0)"],["rotateX(0deg)","rotateX(10deg) matrix(1, 0, 0, 1, 0, 0)"],.5),a(["rotateY(2turn)","rotateY(2rad) matrix(1, 0, 0, 1, 0, 0)"],["rotateY(0rad)","rotateY(2rad) matrix(1, 0, 0, 1, 0, 0)"],.5),a(["rotate(320deg)","rotateY(10grad) matrix(1, 0, 0, 1, 0, 0)"],["rotate(320deg)","rotateY(0deg) matrix(1, 0, 0, 1, 0, 0)"],.5),a(["rotateZ(10grad)","rotateZ(2rad) matrix(1, 0, 0, 1, 0, 0)"],["rotateZ(0rad)","rotateZ(2rad) matrix(1, 0, 0, 1, 0, 0)"],.5),a(["rotate3d(1, 1, 1, 100deg)","rotate3d(1, 1, 1, 2turn) matrix(1, 0, 0, 1, 0, 0)"],["rotate3d(1, 1, 1, 100deg)","rotate3d(1, 1, 1, 0deg) matrix(1, 0, 0, 1, 0, 0)"],.5),a(["skew(30grad)","skew(10deg) matrix(1, 0, 0, 1, 0, 0)"],["skew(0deg)","skew(10deg) matrix(1, 0, 0, 1, 0, 0)"],.5),a(["skewx(3grad)","skewx(1rad) matrix(1, 0, 0, 1, 0, 0)"],["skewx(0rad)","skewx(1rad) matrix(1, 0, 0, 1, 0, 0)"],.5),a(["skewy(3rad)","skewy(1grad) matrix(1, 0, 0, 1, 0, 0)"],["skewy(3rad)","skewy(0rad) matrix(1, 0, 0, 1, 0, 0)"],.5),a(["translate(10in, 20in)","translate(100px, 200px) matrix(1, 0, 0, 1, 0, 0)"],["translate(0px, 0px)","translate(100px, 200px) matrix(1, 0, 0, 1, 0, 0)"],.5),a(["translatex(20in)","translatex(200px) matrix(1, 0, 0, 1, 0, 0)"],["translatex(0px)","translatex(200px) matrix(1, 0, 0, 1, 0, 0)"],.5),a(["translatey(10in)","translatey(100px) matrix(1, 0, 0, 1, 0, 0)"],["translatey(0px)","translatey(100px) matrix(1, 0, 0, 1, 0, 0)"],.5),a(["translatez(10em)","translatez(100px) matrix(1, 0, 0, 1, 0, 0)"],["translatez(0px)","translatez(100px) matrix(1, 0, 0, 1, 0, 0)"],.5),a(["translate3d(10px, 10px, 10px)","translate3d(2rem, 2rem, 2rem) matrix(1, 0, 0, 1, 0, 0)"],["translate3d(10px, 10px, 10px)","translate3d(0px, 0px, 0px) matrix(1, 0, 0, 1, 0, 0)"],.5),a(["perspective(300px)","perspective(9em) matrix(1, 0, 0, 1, 0, 0)"],["perspective(300px)","perspective(0px) matrix(1, 0, 0, 1, 0, 0)"],.5)}),test("transform interpolations involving matrices when matrix code is not available",function(){var t=webAnimationsMinifill.composeMatrix,a=webAnimationsMinifill.quat,r=webAnimationsMinifill.dot,e=webAnimationsMinifill.makeMatrixDecomposition;webAnimationsMinifill.composeMatrix=void 0,webAnimationsMinifill.quat=void 0,webAnimationsMinifill.dot=void 0,webAnimationsMinifill.makeMatrixDecomposition=void 0;var i=function(t,a){var r=webAnimationsMinifill.propertyInterpolation("transform",t,a),e=r(.49);assert.equal(e,t),e=r(.51),assert.equal(e,a)};try{i("matrix(1, 0, 0, 1, 0, 0)","matrix(1, -0.2, 0, 1, 0, 0)"),i("translate(100px) matrix(1, 0, 0, 1, 0, 0) rotate(10deg)","translate(10px) matrix(1, -0.2, 0, 1, 0, 0) rotate(100deg)"),i("translate(10px)","scale(2)"),i("scale(2)","translate(10px)"),i("rotateX(10deg)","rotateY(20deg)"),i("rotateX(10deg)","translate(10px) rotateX(200deg)"),i("rotate(0rad) translate(0px)","translate(800px) rotate(9rad)"),i("translate(0px, 0px) rotate(0deg) scale(1)","scale(3) translate(300px, 90px) rotate(9rad)"),i("translate(0px, 0px) skew(30deg)","skew(0deg) translate(300px, 90px)"),i("matrix(1, 0, 0, 1, 0, 0) translate(100px)","translate(10px) matrix(1, -0.2, 0, 1, 0, 0)")}finally{webAnimationsMinifill.composeMatrix=t,webAnimationsMinifill.quat=a,webAnimationsMinifill.dot=r,webAnimationsMinifill.makeMatrixDecomposition=e}})});