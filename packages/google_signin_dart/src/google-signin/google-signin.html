<polymer-element name=google-signin extends=paper-button-base role=button><template><link rel=stylesheet href="google-signin.css"><core-shared-lib url="https://apis.google.com/js/client.js?onload=%%callback%%"></core-shared-lib><core-signals on-core-signal-google-auth-request="{{authRequest}}"></core-signals><core-signals on-core-signal-google-auth-result="{{authResult}}"></core-signals><template if="{{raised}}"><paper-shadow id=shadow fit animated></paper-shadow></template><div id=button class="height-{{height}} width-{{width}} theme-{{theme}} signedIn-{{signedIn}} additionalAuth-{{additionalAuth}}"><paper-ripple id=ripple fit></paper-ripple><div relative layout horizontal center-center><template if="{{ !signedIn }}"><div class="button-content signIn" tabindex=0 on-click="{{signIn}}" on-keydown="{{signInKeyPress}}"><span class=icon><core-icon icon="google:google-plus"></core-icon></span><span class=buttonText>{{labelSignin}}</span></div></template><template if="{{ signedIn && !additionalAuth }}"><div class="button-content signOut" tabindex=0 on-click="{{signOut}}" on-keydown="{{signOutKeyPress}}"><span class=icon><core-icon icon="google:google-plus"></core-icon></span><span class=buttonText>{{labelSignout}}</span></div></template><template if="{{ signedIn && additionalAuth }}"><div class="button-content signIn" tabindex=0 on-click="{{signIn}}" on-keydown="{{signInKeyPress}}"><span class=icon><core-icon icon="google:google-plus"></core-icon></span><span class=buttonText>{{labelAdditional}}</span></div></template></div></div></template><script>(function(){var g=[];var f=null;var a=null;var d={SHORT:"short",STANDARD:"standard",TALL:"tall"};var c={STANDARD:"Sign in",WIDE:"Sign in with Google"};var e={appPackageName:"apppackagename",clientId:"clientid",cookiePolicy:"cookiepolicy",requestVisibleActions:"requestvisibleactions"};var b={LIGHT:"light",DARK:"dark"};var i={ICON_ONLY:"iconOnly",STANDARD:"standard",WIDE:"wide"};function h(j){if(f){f.fire("core-signal",{name:"google-auth-result",data:{result:j,isGlobal:true}})}}Polymer({attached:function(){if(this.clientId===""){throw"A valid clientId is required to use this element"}if(this.labelSignin===""){if(this.width==i.WIDE){this.labelSignin=c.WIDE}else{if(this.width==i.STANDARD){this.labelSignin=c.STANDARD}}}if(f===null){f=this;window.handleAuthResult=h;var j=document.createElement("meta");j.setAttribute("name","google-signin-clientid");j.setAttribute("content",this.clientId);document.head.appendChild(j);j=document.createElement("meta");j.setAttribute("name","google-signin-scope");j.setAttribute("content",this.scopes);document.head.appendChild(j);j=document.createElement("meta");j.setAttribute("name","google-signin-cookiepolicy");j.setAttribute("content",this.cookiePolicy);document.head.appendChild(j);j=document.createElement("meta");j.setAttribute("name","google-signin-callback");j.setAttribute("content","handleAuthResult");document.head.appendChild(j);if(this.requestVisibleActions){j=document.createElement("meta");j.setAttribute("name","google-signin-requestvisibleactions");j.setAttribute("content",this.requestVisibleActions);document.head.appendChild(j)}}},authRequest:function(q,j,l){if(this!==f){return}var k;var n=this.scopes.split(" ");var p;var m;var o;if(j){p=false;o=j.split(" ");for(k=0;k<o.length;k++){if(o[k]!==""){m=o[k].toLowerCase();if(g.indexOf(m)<0){p=true;if(n.indexOf(m)<0){n.push(m)}}}}}if(p){this.scopes=n.join(" ");if(a){this.additionalAuth=true;this.fire("google-signin-necessary")}}else{this.fire("core-signal",{name:"google-auth-success",data:{result:gapi.auth.getToken(),scopes:g}})}},authResult:function(q,k,m){var s=k.result;if(s&&!s.error){g=[];var p=s.scope.split(" ");for(var n=0;n<p.length;n++){if(p[n]!==""){g.push(p[n].toLowerCase());if(p[n]==="https://www.googleapis.com/auth/userinfo.profile"){g.push("profile")}else{if(p[n]==="https://www.googleapis.com/auth/userinfo.email"){g.push("email")}}}}if(this.offline&&s.code){this.fire("google-signin-offline",{code:s.code})}this.fire("google-signin-success",{result:s,gapi:gapi});if(this===f&&k.isGlobal){this.fire("core-signal",{name:"google-auth-success",data:{result:s,scopes:g}})}this.signedIn=true;this.checkScopes()}else{if(s&&s.error=="access_denied"){var o=this.scopes.split(" ");var p=s.scope.split(" ");var r=false;for(var n=0;n<g.length;n++){for(var l=p.length-1;l>=0;l--){if(g[n]==p[l]){p.splice(l,1)}}}for(var n=0;n<o.length;n++){for(var l=0;l<p.length;l++){if(o[n]==p[l]){r=true;break}}if(r){break}}if(r){this.additionalAuth=true}}else{if(s&&s.error=="user_signed_out"){this.fire("google-signed-out",{result:s});if(this===f&&k.isGlobal){this.fire("core-signal",{name:"google-auth-signed-out",data:{result:s}})}}else{this.fire("google-signin-failure",{result:s});if(this===f&&k.isGlobal){this.fire("core-signal",{name:"google-auth-failure",data:{result:s}})}}g=[];this.signedIn=false}}a=true},checkScopes:function(){var k=this.scopes.split(" ");this.additionalAuth=false;for(var j=0;j<k.length;j++){if(k[j]!==""){if(g.indexOf(k[j].toLowerCase())<0){this.additionalAuth=true;this.fire("google-signin-necessary");break}}}},publish:{appPackageName:"",clientId:"",cookiePolicy:"single_host_origin",height:"standard",fill:true,labelAdditional:"Additional permissions required",labelSignin:"",labelSignout:"Sign out",offline:false,raised:false,requestVisibleActions:"",scopes:"profile",theme:"dark",width:"standard"},signIn:function(){var j=this;var k={clientid:j.clientId,cookiepolicy:j.cookiePolicy,scope:j.scopes,requestvisibleactions:j.requestVisibleActions,callback:function(l){j.fire("core-signal",{name:"google-auth-result",data:{result:l,isGlobal:false}})}};if(j.offline){k.accesstype="offline";k.redirecturi="postmessage"}Object.keys(e).forEach(function(l){if(j[l]&&j[l]!==""){k[e[l]]=j[l]}});a=false;gapi.auth.signIn(k)},signedIn:false,signInKeyPress:function(j){if(j.which==13||j.keyCode==13||j.which==32||j.keyCode==32){j.preventDefault();this.signIn()}},signOut:function(){a=false;this.fire("google-signout-attempted");gapi.auth.signOut()},signOutKeyPress:function(j){if(j.which==13||j.keyCode==13||j.which==32||j.keyCode==32){j.preventDefault();this.signOut()}}})}());</script></polymer-element><polymer-element name=google-signin-aware attributes=scopes><template><core-signals on-core-signal-google-auth-success="{{authSuccess}}"></core-signals><core-signals on-core-signal-google-auth-failure="{{authFailure}}"></core-signals><core-signals on-core-signal-google-auth-signed-out="{{signedOut}}"></core-signals></template><script>(function(){var a=null;Polymer({scopes:"",domReady:function(){this.fire("core-signal",{name:"google-auth-request",data:this.scopes})},authSuccess:function(g,c){var b=false;if(c&&c.scopes){var f=this.scopes.split(" ");b=true;for(var d=0;d<f.length;d++){if(f[d]!==""&&c.scopes.indexOf(f[d].toLowerCase())<0){b=false;break}}}if(b){this.fire("google-signin-aware-success",c)}},authFailure:function(c,b){this.fire("google-signin-aware-failure",b)},signedOut:function(c,b){this.fire("google-signin-aware-signed-out",b)}})})();</script></polymer-element>