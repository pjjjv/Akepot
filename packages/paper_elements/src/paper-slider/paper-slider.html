<link rel=import href="../core-a11y-keys/core-a11y-keys.html"><link rel=import href="../paper-progress/paper-progress.html"><link rel=import href="../paper-input/paper-input.html"><polymer-element name=paper-slider extends=core-range attributes="snaps pin disabled secondaryProgress editable immediateValue" role=slider tabindex=0 aria-valuemin=0 aria-valuemax=100><template><link rel=stylesheet href="paper-slider.css"><template if="{{!disabled}}"><core-a11y-keys target="{{}}" keys="left down pagedown home" on-keys-pressed="{{decrementKey}}"></core-a11y-keys><core-a11y-keys target="{{}}" keys="right up pageup end" on-keys-pressed="{{incrementKey}}"></core-a11y-keys></template><div id="sliderContainer" class="{{ {disabled: disabled, pin: pin, snaps: snaps, ring: immediateValue <= min, expand: expand, dragging: dragging, transiting: transiting, editable: editable} | tokenList }}"><div class=bar-container><paper-progress id=sliderBar aria-hidden=true min="{{min}}" max="{{max}}" value="{{immediateValue}}" secondaryProgress="{{secondaryProgress}}" on-down="{{bardown}}" on-up="{{resetKnob}}" on-trackstart="{{trackStart}}" on-trackx="{{trackx}}" on-trackend="{{trackEnd}}"></paper-progress></div><template if="{{snaps && !disabled}}"><div class=slider-markers horizontal layout><template repeat="{{markers}}"><div flex class=slider-marker></div></template></div></template><div id=sliderKnob on-down="{{knobdown}}" on-up="{{resetKnob}}" on-trackstart="{{trackStart}}" on-trackx="{{trackx}}" on-trackend="{{trackEnd}}" on-transitionend="{{knobTransitionEnd}}" center-justified center horizontal layout><div id=sliderKnobInner value="{{immediateValue}}"></div></div></div><template if="{{editable}}"><paper-input id=input class=slider-input value="{{immediateValue}}" disabled?="{{disabled}}" on-change="{{inputChange}}"></paper-input></template></template><script>Polymer("paper-slider",{snaps:false,pin:false,disabled:false,secondaryProgress:0,editable:false,maxMarkers:100,observe:{"step snaps":"update"},ready:function(){this.update()},update:function(){this.positionKnob(this.calcRatio(this.value));this.updateMarkers()},minChanged:function(){this.update();this.setAttribute("aria-valuemin",this.min)},maxChanged:function(){this.update();this.setAttribute("aria-valuemax",this.max)},valueChanged:function(){this.update();this.setAttribute("aria-valuenow",this.value);this.fire("core-change")},disabledChanged:function(){if(this.disabled){this.removeAttribute("tabindex")}else{this.tabIndex=0}},immediateValueChanged:function(){if(!this.dragging){this.value=this.immediateValue}},expandKnob:function(){this.expand=true},resetKnob:function(){this.expandJob&&this.expandJob.stop();this.expand=false},positionKnob:function(a){this.immediateValue=this.calcStep(this.calcKnobPosition(a))||0;this._ratio=this.snaps?this.calcRatio(this.immediateValue):a;this.$.sliderKnob.style.left=this._ratio*100+"%"},inputChange:function(){this.value=this.$.input.value;this.fire("change")},calcKnobPosition:function(a){return(this.max-this.min)*a+this.min},trackStart:function(a){this._w=this.$.sliderBar.offsetWidth;this._x=this._ratio*this._w;this._startx=this._x||0;this._minx=-this._startx;this._maxx=this._w-this._startx;this.$.sliderKnob.classList.add("dragging");this.dragging=true;a.preventTap()},trackx:function(c){var a=Math.min(this._maxx,Math.max(this._minx,c.dx));this._x=this._startx+a;this.immediateValue=this.calcStep(this.calcKnobPosition(this._x/this._w))||0;var b=this.$.sliderKnob.style;b.transform=b.webkitTransform="translate3d("+(this.snaps?(this.calcRatio(this.immediateValue)*this._w)-this._startx:a)+"px, 0, 0)"},trackEnd:function(){var a=this.$.sliderKnob.style;a.transform=a.webkitTransform="";this.$.sliderKnob.classList.remove("dragging");this.dragging=false;this.resetKnob();this.value=this.immediateValue;this.fire("change")},knobdown:function(a){a.preventDefault();this.expandKnob()},bardown:function(c){c.preventDefault();this.transiting=true;this._w=this.$.sliderBar.offsetWidth;var b=this.$.sliderBar.getBoundingClientRect();var a=(c.x-b.left)/this._w;this.positionKnob(a);this.expandJob=this.job(this.expandJob,this.expandKnob,60);this.fire("change")},knobTransitionEnd:function(a){if(a.target===this.$.sliderKnob){this.transiting=false}},updateMarkers:function(){this.markers=[];var a=(this.max-this.min)/this.step;if(!this.snaps&&a>this.maxMarkers){return}for(var b=0;b<a;b++){this.markers.push("")}},increment:function(){this.value=this.clampValue(this.value+this.step)},decrement:function(){this.value=this.clampValue(this.value-this.step)},incrementKey:function(b,a){if(a.key==="end"){this.value=this.max}else{this.increment()}this.fire("change")},decrementKey:function(b,a){if(a.key==="home"){this.value=this.min}else{this.decrement()}this.fire("change")}});</script></polymer-element>