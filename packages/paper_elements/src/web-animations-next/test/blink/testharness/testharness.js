!function(){function t(){var t=document.getElementsByTagName("title")[0],e=t&&t.firstChild&&t.firstChild.data||"Untitled",s=ue>0?" "+ue:"";return ue++,e+s}function e(e,s,r){var a=s?s:t();r=r?r:{};var n=new $(a,r);n.step(e,n,n),n.phase===n.phases.STARTED&&n.done()}function s(e,s,r){"function"!=typeof e&&(r=s,s=e,e=null);var a=s?s:t();r=r?r:{};var n=new $(a,r);return e&&n.step(e,n,n),n}function r(t,e){var s=null,r={};2===arguments.length?(s=t,r=e):t instanceof Function?s=t:r=t,ce.setup(s,r),pe.setup(r)}function a(){0===ce.tests.length&&ce.set_file_is_test(),ce.file_is_test&&ce.tests[0].done(),ce.end_wait()}function n(t,s,r){Z(s,function(s,a){var n=s[0];e(function(){t.apply(this,s.slice(1))},n,Array.isArray(r)?r[a]:r)})}function o(t,e,s){t.addEventListener(e,s,!1)}function i(t,e){return t.length>e?t.substring(0,e-3)+"...":t}function u(t){if("nodeType"in t&&"nodeName"in t&&"nodeValue"in t&&"childNodes"in t){try{t.nodeType}catch(t){return!1}return!0}return!1}function c(t,e){if(e||(e=[]),"object"==typeof t&&null!==t){if(e.indexOf(t)>=0)return"[...]";e.push(t)}if(Array.isArray(t))return"["+t.map(function(t){return c(t,e)}).join(", ")+"]";switch(typeof t){case"string":t=t.replace("\\","\\\\");for(var s=0;32>s;s++){var r="\\";switch(s){case 0:r+="0";break;case 1:r+="x01";break;case 2:r+="x02";break;case 3:r+="x03";break;case 4:r+="x04";break;case 5:r+="x05";break;case 6:r+="x06";break;case 7:r+="x07";break;case 8:r+="b";break;case 9:r+="t";break;case 10:r+="n";break;case 11:r+="v";break;case 12:r+="f";break;case 13:r+="r";break;case 14:r+="x0e";break;case 15:r+="x0f";break;case 16:r+="x10";break;case 17:r+="x11";break;case 18:r+="x12";break;case 19:r+="x13";break;case 20:r+="x14";break;case 21:r+="x15";break;case 22:r+="x16";break;case 23:r+="x17";break;case 24:r+="x18";break;case 25:r+="x19";break;case 26:r+="x1a";break;case 27:r+="x1b";break;case 28:r+="x1c";break;case 29:r+="x1d";break;case 30:r+="x1e";break;case 31:r+="x1f"}t=t.replace(RegExp(String.fromCharCode(s),"g"),r)}return'"'+t.replace(/"/g,'\\"')+'"';case"boolean":case"undefined":return String(t);case"number":return t===-0&&1/t===-1/0?"-0":String(t);case"object":if(null===t)return"null";if(u(t))switch(t.nodeType){case Node.ELEMENT_NODE:for(var a="<"+t.localName,s=0;s<t.attributes.length;s++)a+=" "+t.attributes[s].name+'="'+t.attributes[s].value+'"';return a+=">"+t.innerHTML+"</"+t.localName+">","Element node "+i(a,60);case Node.TEXT_NODE:return'Text node "'+i(t.data,60)+'"';case Node.PROCESSING_INSTRUCTION_NODE:return"ProcessingInstruction node with target "+c(i(t.target,60))+" and data "+c(i(t.data,60));case Node.COMMENT_NODE:return"Comment node <!--"+i(t.data,60)+"-->";case Node.DOCUMENT_NODE:return"Document node with "+t.childNodes.length+(1==t.childNodes.length?" child":" children");case Node.DOCUMENT_TYPE_NODE:return"DocumentType node";case Node.DOCUMENT_FRAGMENT_NODE:return"DocumentFragment node with "+t.childNodes.length+(1==t.childNodes.length?" child":" children");default:return"Node object of unknown type"}default:return typeof t+' "'+i(String(t),60)+'"'}}function p(t,e){K(t===!0,"assert_true",e,"expected true got ${actual}",{actual:t})}function l(t,e){K(t===!1,"assert_false",e,"expected false got ${actual}",{actual:t})}function h(t,e){return e!==e?t!==t:0===t&&0===e?1/t===1/e:t===e}function _(t,e,s){return typeof t!=typeof e?void K(!1,"assert_equals",s,"expected ("+typeof e+") ${expected} but got ("+typeof t+") ${actual}",{expected:e,actual:t}):void K(h(t,e),"assert_equals",s,"expected ${expected} but got ${actual}",{expected:e,actual:t})}function d(t,e,s){K(!h(t,e),"assert_not_equals",s,"got disallowed value ${actual}",{actual:t})}function f(t,e,s){K(-1!=e.indexOf(t),"assert_in_array",s,"value ${actual} not in array ${expected}",{actual:t,expected:e})}function m(t,e,s){function r(t,e,a){a.push(t);var n;for(n in t)K(e.hasOwnProperty(n),"assert_object_equals",s,"unexpected property ${p}",{p:n}),"object"==typeof t[n]&&null!==t[n]?-1===a.indexOf(t[n])&&r(t[n],e[n],a):K(h(t[n],e[n]),"assert_object_equals",s,"property ${p} expected ${expected} got ${actual}",{p:n,expected:e,actual:t});for(n in e)K(t.hasOwnProperty(n),"assert_object_equals",s,"expected property ${p} missing",{p:n});a.pop()}r(t,e,[])}function y(t,e,s){K(t.length===e.length,"assert_array_equals",s,"lengths differ, expected ${expected} got ${actual}",{expected:e.length,actual:t.length});for(var r=0;r<t.length;r++)K(t.hasOwnProperty(r)===e.hasOwnProperty(r),"assert_array_equals",s,"property ${i}, property expected to be $expected but was $actual",{i:r,expected:e.hasOwnProperty(r)?"present":"missing",actual:t.hasOwnProperty(r)?"present":"missing"}),K(h(e[r],t[r]),"assert_array_equals",s,"property ${i}, expected ${expected} but got ${actual}",{i:r,expected:e[r],actual:t[r]})}function E(t,e,s,r){K("number"==typeof t,"assert_approx_equals",r,"expected a number but got a ${type_actual}",{type_actual:typeof t}),K(Math.abs(t-e)<=s,"assert_approx_equals",r,"expected ${expected} +/- ${epsilon} but got ${actual}",{expected:e,actual:t,epsilon:s})}function g(t,e,s){K("number"==typeof t,"assert_less_than",s,"expected a number but got a ${type_actual}",{type_actual:typeof t}),K(e>t,"assert_less_than",s,"expected a number less than ${expected} but got ${actual}",{expected:e,actual:t})}function b(t,e,s){K("number"==typeof t,"assert_greater_than",s,"expected a number but got a ${type_actual}",{type_actual:typeof t}),K(t>e,"assert_greater_than",s,"expected a number greater than ${expected} but got ${actual}",{expected:e,actual:t})}function T(t,e,s){K("number"==typeof t,"assert_less_than_equal",s,"expected a number but got a ${type_actual}",{type_actual:typeof t}),K(e>=t,"assert_less_than",s,"expected a number less than or equal to ${expected} but got ${actual}",{expected:e,actual:t})}function x(t,e,s){K("number"==typeof t,"assert_greater_than_equal",s,"expected a number but got a ${type_actual}",{type_actual:typeof t}),K(t>=e,"assert_greater_than_equal",s,"expected a number greater than or equal to ${expected} but got ${actual}",{expected:e,actual:t})}function v(t,e,s){K(e.test(t),"assert_regexp_match",s,"expected ${expected} but got ${actual}",{expected:e,actual:t})}function R(t,e,s){_({}.toString.call(t),"[object "+e+"]",s)}function S(t){return function(e,s,r){K(e.hasOwnProperty(s),t,r,"expected property ${p} missing",{p:s})}}function w(t,e,s){K(!t.hasOwnProperty(e),"assert_not_exists",s,"unexpected property ${p} found",{p:e})}function N(t){return function(e,s,r){K("object"==typeof e,t,r,"provided value is not an object"),K("hasOwnProperty"in e,t,r,"provided value is an object but has no hasOwnProperty method"),K(!e.hasOwnProperty(s),t,r,"property ${p} found on object expected in prototype chain",{p:s}),K(s in e,t,r,"property ${p} not found in prototype chain",{p:s})}}function O(t,e,s){var r=t[e];try{t[e]=r+"a",K(h(t[e],r),"assert_readonly",s,"changing property ${p} succeeded",{p:e})}finally{t[e]=r}}function A(t,e,s){try{e.call(this),K(!1,"assert_throws",s,"${func} did not throw",{func:e})}catch(u){if(u instanceof W)throw u;if(null===t)return;if("object"==typeof t)return void K("object"==typeof u&&"name"in u&&u.name==t.name,"assert_throws",s,"${func} threw ${actual} (${actual_name}) expected ${expected} (${expected_name})",{func:e,actual:u,actual_name:u.name,expected:t,expected_name:t.name});var r={INDEX_SIZE_ERR:"IndexSizeError",HIERARCHY_REQUEST_ERR:"HierarchyRequestError",WRONG_DOCUMENT_ERR:"WrongDocumentError",INVALID_CHARACTER_ERR:"InvalidCharacterError",NO_MODIFICATION_ALLOWED_ERR:"NoModificationAllowedError",NOT_FOUND_ERR:"NotFoundError",NOT_SUPPORTED_ERR:"NotSupportedError",INVALID_STATE_ERR:"InvalidStateError",SYNTAX_ERR:"SyntaxError",INVALID_MODIFICATION_ERR:"InvalidModificationError",NAMESPACE_ERR:"NamespaceError",INVALID_ACCESS_ERR:"InvalidAccessError",TYPE_MISMATCH_ERR:"TypeMismatchError",SECURITY_ERR:"SecurityError",NETWORK_ERR:"NetworkError",ABORT_ERR:"AbortError",URL_MISMATCH_ERR:"URLMismatchError",QUOTA_EXCEEDED_ERR:"QuotaExceededError",TIMEOUT_ERR:"TimeoutError",INVALID_NODE_TYPE_ERR:"InvalidNodeTypeError",DATA_CLONE_ERR:"DataCloneError"},a=t in r?r[t]:t,n={IndexSizeError:1,HierarchyRequestError:3,WrongDocumentError:4,InvalidCharacterError:5,NoModificationAllowedError:7,NotFoundError:8,NotSupportedError:9,InvalidStateError:11,SyntaxError:12,InvalidModificationError:13,NamespaceError:14,InvalidAccessError:15,TypeMismatchError:17,SecurityError:18,NetworkError:19,AbortError:20,URLMismatchError:21,QuotaExceededError:22,TimeoutError:23,InvalidNodeTypeError:24,DataCloneError:25,UnknownError:0,ConstraintError:0,DataError:0,TransactionInactiveError:0,ReadOnlyError:0,VersionError:0};if(!(a in n))throw new W('Test bug: unrecognized DOMException code "'+t+'" passed to assert_throws()');var o={code:n[a]};(0===o.code||"name"in u&&u.name!==u.name.toUpperCase()&&"DOMException"!==u.name)&&(o.name=a),K("object"==typeof u,"assert_throws",s,"${func} threw ${e} with type ${type}, not an object",{func:e,e:u,type:typeof u});for(var i in o)K("object"==typeof u&&i in u&&u[i]==o[i],"assert_throws",s,"${func} threw ${e} that is not a DOMException "+t+": property ${prop} is equal to ${actual}, expected ${expected}",{func:e,e:u,prop:i,actual:u[i],expected:o[i]})}}function I(t){K(!1,"assert_unreached",t,"Reached unreachable code")}function k(t,e,s){var r=[].slice.call(arguments,3),a=[],n=!1;if(Z(s,function(s){try{t.apply(this,[e,s].concat(r)),n=!0}catch(t){a.push(t.message)}}),!n)throw new W(a.join("\n\n"))}function $(t,e){if(ce.file_is_test&&ce.tests.length)throw new Error("Tried to create a test with file_is_test");this.name=t,this.phases={INITIAL:0,STARTED:1,HAS_RESULT:2,COMPLETE:3},this.phase=this.phases.INITIAL,this.status=this.NOTRUN,this.timeout_id=null,this.properties=e;var s=e.timeout?e.timeout:ne.test_timeout;this.timeout_length=null!=s?s*ce.timeout_multiplier:null,this.message=null,this.steps=[],this.cleanup_callbacks=[],ce.push(this)}function C(){this.status=null,this.message=null}function M(){this.tests=[],this.num_pending=0,this.phases={INITIAL:0,SETUP:1,HAVE_TESTS:2,HAVE_RESULTS:3,COMPLETE:4},this.phase=this.phases.INITIAL,this.properties={},this.all_loaded=!1,this.wait_for_finish=!1,this.processing_callbacks=!1,this.allow_uncaught_exception=!1,this.file_is_test=!1,this.timeout_multiplier=1,this.timeout_length=this.get_timeout(),this.timeout_id=null,this.start_callbacks=[],this.test_done_callbacks=[],this.all_done_callbacks=[],this.status=new C;var t=this;o(window,"load",function(){t.all_loaded=!0,t.all_done()&&t.complete()}),this.set_timeout()}function L(){null===ce.timeout_length&&ce.timeout()}function D(t){ce.start_callbacks.push(t)}function P(t){ce.test_done_callbacks.push(t)}function U(t){ce.all_done_callbacks.push(t)}function j(){this.output_document=document,this.output_node=null,this.done_count=0,this.enabled=ne.output,this.phase=this.INITIAL}function q(t){return"string"==typeof t[0]}function H(t,e){if("function"==typeof t){var s=t(e);return s?H(s,e):null}return q(t)?V(t,e):X(z(t,function(t){return H(t,e)}),function(t){return null!==t})}function V(t,e){function s(t){for(var s=t.split(n),r=[],a=0;a<s.length;a+=2)r.push(s[a]),s[a+1]&&r.push(String(e[s[a+1]]));return r}function r(e,r){r[1]={};for(var a in t[1])if(e.hasOwnProperty(a)){var n=s(a).join(""),o=s(e[a]).join("");r[1][n]=o}}function a(t,r){for(var a=0;a<t.length;a++)if(t[a]instanceof Object){var n=H(t[a],e);null!==n&&(q(n)?r.push(n):G(r,n))}else G(r,s(String(t[a])));return r}var n=/\$\{([^ }]*)\}/g,o=[];return o.push(s(String(t[0])).join("")),"{text}"===t[0]?a(t.slice(1),o):(r(t[1],o),a(t.slice(2),o)),o}function F(t,e){var s,r=e||document;if("{text}"===t[0]){s=r.createTextNode("");for(var a=1;a<t.length;a++)s.data+=t[a]}else{s=r.createElementNS(oe,t[0]);for(var n in t[1])t[1].hasOwnProperty(n)&&s.setAttribute(n,t[1][n]);for(var a=2;a<t.length;a++)if(t[a]instanceof Object){var o=B(t[a]);s.appendChild(o)}else{var i=r.createTextNode(t[a]);s.appendChild(i)}}return s}function B(t,e,s){return q(t)?F(t,s):z(t,function(t){return F(t,s)})}function Y(t,e,s){return B(H(t,e),s)}function K(t,e,s,r,a){if(0===ce.tests.length&&ce.set_file_is_test(),t!==!0){var n=Q(e,s,r,a);throw new W(n)}}function W(t){this.message=t}function Q(t,e,s,r){for(var a in r)r.hasOwnProperty(a)&&(r[a]=c(r[a]));var n=H(["{text}","${function_name}: ${description}"+s],J({function_name:t,description:e?e+" ":""},r));return n.slice(1).join("")}function X(t,e,s){for(var r=[],a=0;a<t.length;a++)if(t.hasOwnProperty(a)){var n=e.call(s,t[a],a,t);n&&r.push(t[a])}return r}function z(t,e,s){var r=[];r.length=t.length;for(var a=0;a<t.length;a++)t.hasOwnProperty(a)&&(r[a]=e.call(s,t[a],a,t));return r}function G(t,e){Array.prototype.push.apply(t,e)}function Z(t,e,s){for(var r=0;r<t.length;r++)t.hasOwnProperty(r)&&e.call(s,t[r],r,t)}function J(t,e){var s,r={};for(s in t)r[s]=t[s];for(s in e)r[s]=e[s];return r}function te(t,e){for(var s=e.split("."),r=window,a=0;a<s.length-1;a++)s[a]in r||(r[s[a]]={}),r=r[s[a]];r[s[s.length-1]]=t}function ee(t){var e=ee.result_cache;if(!e){e=[[self,!0]];for(var s,r=self,a=0,n=location.ancestorOrigins;r!=r.parent;)r=r.parent,s=n?location.origin==n[a]:se(r),e.push([r,s]),a++;r=window.opener,r&&e.push([r,se(r)]),ee.result_cache=e}Z(e,function(e){t.apply(null,e)})}function se(t){try{return!0}catch(t){return!1}}function re(t){var e,s;try{s=typeof t.postMessage,e="function"===s?!0:"object"===s?!0:!1}catch(t){e=!1}return e}var ae=!1,ne={output:!0,harness_timeout:{normal:1e4,long:6e4},test_timeout:null},oe="http://www.w3.org/1999/xhtml",ie=null;!function(){for(var t=document.getElementsByTagName("script"),e=0;e<t.length;e++){var s;if(t[e].src?s=t[e].src:t[e].href&&(s=t[e].href.baseVal),s&&"testharness.js"===s.slice(s.length-"testharness.js".length)){ie=s.slice(0,s.length-"testharness.js".length);break}}}();var ue=0;te(e,"test"),te(s,"async_test"),te(n,"generate_tests"),te(r,"setup"),te(a,"done"),te(o,"on_event"),te(c,"format_value"),te(p,"assert_true"),te(l,"assert_false"),te(_,"assert_equals"),te(d,"assert_not_equals"),te(f,"assert_in_array"),te(m,"assert_object_equals"),te(y,"assert_array_equals"),te(E,"assert_approx_equals"),te(g,"assert_less_than"),te(b,"assert_greater_than"),te(T,"assert_less_than_equal"),te(x,"assert_greater_than_equal"),te(v,"assert_regexp_match"),te(R,"assert_class_string"),te(S("assert_exists"),"assert_exists"),te(S("assert_own_property"),"assert_own_property"),te(w,"assert_not_exists"),te(N("assert_inherits"),"assert_inherits"),te(N("assert_idl_attribute"),"assert_idl_attribute"),te(O,"assert_readonly"),te(A,"assert_throws"),te(I,"assert_unreached"),te(k,"assert_any"),$.statuses={PASS:0,FAIL:1,TIMEOUT:2,NOTRUN:3},$.prototype=J({},$.statuses),$.prototype.structured_clone=function(){if(!this._structured_clone){var t=this.message;t=t?String(t):t,this._structured_clone=J({name:String(this.name),status:this.status,message:t},$.statuses)}return this._structured_clone},$.prototype.step=function(t,e){if(!(this.phase>this.phases.STARTED)){this.phase=this.phases.STARTED,this.set_status(this.TIMEOUT,"Test timed out"),ce.started=!0,null===this.timeout_id&&this.set_timeout(),this.steps.push(t),1===arguments.length&&(e=this);try{return t.apply(e,Array.prototype.slice.call(arguments,2))}catch(t){if(this.phase>=this.phases.HAS_RESULT)return;var s="object"==typeof t&&null!==t?t.message:t;"undefined"!=typeof t.stack&&"string"==typeof t.message&&(s+="(stack: "+t.stack+")"),this.set_status(this.FAIL,s),this.phase=this.phases.HAS_RESULT,this.done()}}},$.prototype.step_func=function(t,e){var s=this;return 1===arguments.length&&(e=s),function(){return s.step.apply(s,[t,e].concat(Array.prototype.slice.call(arguments)))}},$.prototype.step_func_done=function(t,e){var s=this;return 1===arguments.length&&(e=s),function(){t&&s.step.apply(s,[t,e].concat(Array.prototype.slice.call(arguments))),s.done()}},$.prototype.unreached_func=function(t){return this.step_func(function(){I(t)})},$.prototype.add_cleanup=function(t){this.cleanup_callbacks.push(t)},$.prototype.force_timeout=function(){this.set_status(this.TIMEOUT),this.phase=this.phases.HAS_RESULT},$.prototype.set_timeout=function(){if(null!==this.timeout_length){var t=this;this.timeout_id=setTimeout(function(){t.timeout()},this.timeout_length)}},$.prototype.set_status=function(t,e){this.status=t,this.message=e},$.prototype.timeout=function(){this.timeout_id=null,this.set_status(this.TIMEOUT,"Test timed out"),this.phase=this.phases.HAS_RESULT,this.done()},$.prototype.done=function(){this.phase!=this.phases.COMPLETE&&(this.phase<=this.phases.STARTED&&this.set_status(this.PASS,null),this.status==this.NOTRUN&&alert(this.phase),this.phase=this.phases.COMPLETE,clearTimeout(this.timeout_id),ce.result(this),this.cleanup())},$.prototype.cleanup=function(){Z(this.cleanup_callbacks,function(t){t()})},C.statuses={OK:0,ERROR:1,TIMEOUT:2},C.prototype=J({},C.statuses),C.prototype.structured_clone=function(){if(!this._structured_clone){var t=this.message;t=t?String(t):t,this._structured_clone=J({status:this.status,message:t},C.statuses)}return this._structured_clone},M.prototype.setup=function(t,e){if(!(this.phase>=this.phases.HAVE_RESULTS)){this.phase<this.phases.SETUP&&(this.phase=this.phases.SETUP),this.properties=e;for(var s in e)if(e.hasOwnProperty(s)){var r=e[s];"allow_uncaught_exception"==s?this.allow_uncaught_exception=r:"explicit_done"==s&&r?this.wait_for_finish=!0:"explicit_timeout"==s&&r?(this.timeout_length=null,this.timeout_id&&clearTimeout(this.timeout_id)):"timeout_multiplier"==s&&(this.timeout_multiplier=r)}if(t)try{t()}catch(t){this.status.status=this.status.ERROR,this.status.message=String(t)}this.set_timeout()}},M.prototype.set_file_is_test=function(){if(this.tests.length>0)throw new Error("Tried to set file as test after creating a test");this.wait_for_finish=!0,this.file_is_test=!0,s()},M.prototype.get_timeout=function(){for(var t=document.getElementsByTagName("meta"),e=0;e<t.length;e++)if("timeout"==t[e].name){if("long"==t[e].content)return ne.harness_timeout.long;break}return ne.harness_timeout.normal},M.prototype.set_timeout=function(){var t=this;clearTimeout(this.timeout_id),null!==this.timeout_length&&(this.timeout_id=setTimeout(function(){t.timeout()},this.timeout_length))},M.prototype.timeout=function(){null===this.status.status&&(this.status.status=this.status.TIMEOUT),this.complete()},M.prototype.end_wait=function(){this.wait_for_finish=!1,this.all_done()&&this.complete()},M.prototype.push=function(t){this.phase<this.phases.HAVE_TESTS&&this.start(),this.num_pending++,this.tests.push(t)},M.prototype.all_done=function(){return this.tests.length>0&&this.all_loaded&&0===this.num_pending&&!this.wait_for_finish&&!this.processing_callbacks},M.prototype.start=function(){this.phase=this.phases.HAVE_TESTS,this.notify_start()},M.prototype.notify_start=function(){var t=this;Z(this.start_callbacks,function(e){e(t.properties)}),ee(function(e,s){if(s&&e.start_callback)try{e.start_callback(t.properties)}catch(t){if(ae)throw t}re(e)&&e!==self&&e.postMessage({type:"start",properties:t.properties},"*")})},M.prototype.result=function(t){this.phase>this.phases.HAVE_RESULTS||(this.phase=this.phases.HAVE_RESULTS,this.num_pending--,this.notify_result(t))},M.prototype.notify_result=function(t){var e=this;this.processing_callbacks=!0,Z(this.test_done_callbacks,function(s){s(t,e)}),ee(function(e,s){if(s&&e.result_callback)try{e.result_callback(t)}catch(t){if(ae)throw t}re(e)&&e!==self&&e.postMessage({type:"result",test:t.structured_clone()},"*")}),this.processing_callbacks=!1,e.all_done()&&e.complete()},M.prototype.complete=function(){if(this.phase!==this.phases.COMPLETE){this.phase=this.phases.COMPLETE;var t=this;this.tests.forEach(function(e){e.status===e.NOTRUN&&(t.notify_result(e),e.cleanup())}),this.notify_complete()}},M.prototype.notify_complete=function(){clearTimeout(this.timeout_id);var t=this,e=z(t.tests,function(t){return t.structured_clone()});null===this.status.status&&(this.status.status=this.status.OK),Z(this.all_done_callbacks,function(e){e(t.tests,t.status)}),ee(function(s,r){if(r&&s.completion_callback)try{s.completion_callback(t.tests,t.status)}catch(t){if(ae)throw t}re(s)&&s!==self&&s.postMessage({type:"complete",tests:e,status:t.status.structured_clone()},"*")})};var ce=new M;addEventListener("error",function(t){if(ce.file_is_test){var e=ce.tests[0];if(e.phase>=e.phases.HAS_RESULT)return;var s=t.message;e.set_status(e.FAIL,s),e.phase=e.phases.HAS_RESULT,e.done(),a()}else ce.allow_uncaught_exception||(ce.status.status=ce.status.ERROR,ce.status.message=t.message)}),te(L,"timeout"),te(D,"add_start_callback"),te(P,"add_result_callback"),te(U,"add_completion_callback"),j.prototype.INITIAL=0,j.prototype.STARTED=1,j.prototype.HAVE_RESULTS=2,j.prototype.COMPLETE=3,j.prototype.setup=function(t){this.phase>this.INITIAL||(this.enabled=this.enabled&&(t.hasOwnProperty("output")?t.output:ne.output))},j.prototype.init=function(t){this.phase>=this.STARTED||(this.output_document=t.output_document?t.output_document:document,this.phase=this.STARTED)},j.prototype.resolve_log=function(){var t;if(t="function"==typeof this.output_document?this.output_document.apply(void 0):this.output_document){var e=t.getElementById("log");if(!e){if(!document.body||"loading"==document.readyState)return;e=t.createElement("div"),e.id="log",t.body.appendChild(e)}this.output_document=t,this.output_node=e}},j.prototype.show_status=function(){this.phase<this.STARTED&&this.init(),this.enabled&&(this.phase<this.HAVE_RESULTS&&(this.resolve_log(),this.phase=this.HAVE_RESULTS),this.done_count++,this.output_node&&(this.done_count<100||this.done_count<1e3&&this.done_count%100===0||this.done_count%1e3===0)&&(this.output_node.textContent="Running, "+this.done_count+" complete, "+ce.num_pending+" remain"))},j.prototype.show_results=function(t,e){function s(t){return t.replace(/\s/g,"").toLowerCase()}function r(t){return t.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function a(){for(var e=0;e<t.length;e++)if(t[e].properties.hasOwnProperty("assert"))return!0;return!1}function n(t){return t.properties.hasOwnProperty("assert")?Array.isArray(t.properties.assert)?t.properties.assert.join(" "):t.properties.assert:""}if(!(this.phase>=this.COMPLETE)&&this.enabled){this.output_node||this.resolve_log(),this.phase=this.COMPLETE;var i=this.output_node;if(i){for(var u=this.output_document;i.lastChild;)i.removeChild(i.lastChild);if(null!=ie){var c=u.createElementNS(oe,"link");c.setAttribute("rel","stylesheet"),c.setAttribute("href",ie+"testharness.css");var p=u.getElementsByTagName("head");p.length&&p[0].appendChild(c)}var l={};l[e.OK]="OK",l[e.ERROR]="Error",l[e.TIMEOUT]="Timeout";var h={};h[$.prototype.PASS]="Pass",h[$.prototype.FAIL]="Fail",h[$.prototype.TIMEOUT]="Timeout",h[$.prototype.NOTRUN]="Not Run";var _={};Z(t,function(t){var e=h[t.status];_.hasOwnProperty(e)?_[e]+=1:_[e]=1});var d=["section",{id:"summary"},["h2",{},"Summary"],function(){var t=l[e.status],r=[["section",{},["p",{},"Harness status: ",["span",{class:s(t)},t]]]];return e.status===e.ERROR&&r[0].push(["pre",{},e.message]),r},["p",{},"Found ${num_tests} tests"],function(){for(var t=[["div",{}]],e=0;h.hasOwnProperty(e);){if(_.hasOwnProperty(h[e])){var r=h[e];t[0].push(["div",{class:s(r)},["label",{},["input",{type:"checkbox",checked:"checked"}],_[r]+" "+r]])}e++}return t}];i.appendChild(Y(d,{num_tests:t.length},u)),Z(u.querySelectorAll("section#summary label"),function(t){o(t,"click",function(e){if(null===u.getElementById("results"))return void e.preventDefault();var s=t.parentNode.getAttribute("class"),r=u.querySelector("style#hide-"+s),a=t.querySelector("input");r||a.checked?r&&a.checked&&r.parentNode.removeChild(r):(r=u.createElementNS(oe,"style"),r.id="hide-"+s,r.textContent="table#results > tbody > tr."+s+"{display:none}",u.body.appendChild(r))})}),i.appendChild(document.createElementNS(oe,"section"));for(var f=a(),m="<h2>Details</h2><table id='results' "+(f?"class='assertions'":"")+"><thead><tr><th>Result</th><th>Test Name</th>"+(f?"<th>Assertion</th>":"")+"<th>Message</th></tr></thead><tbody>",y=0;y<t.length;y++)m+='<tr class="'+r(s(h[t[y].status]))+'"><td>'+r(h[t[y].status])+"</td><td>"+r(t[y].name)+"</td><td>"+(f?r(n(t[y]))+"</td><td>":"")+r(t[y].message?t[y].message:" ")+"</td></tr>";m+="</tbody></table>";try{i.lastChild.innerHTML=m}catch(t){i.appendChild(document.createElementNS(oe,"p")).textContent="Setting innerHTML for the log threw an exception.",i.appendChild(document.createElementNS(oe,"pre")).textContent=m}}}};var pe=new j;D(function(t){pe.init(t)}),P(function(){pe.show_status()}),U(function(t,e){pe.show_results(t,e)}),W.prototype.toString=function(){return this.message}}();